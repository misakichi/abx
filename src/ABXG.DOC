とりあえず書いてみただけの^^;
                ABX 用画像コンバート定義ファイル

                        ABXG.cfg        v0.10



■  はじめに

      abxg.cfg ファイルは abx.exe を用いて、 複数のdos汎用画像コンバ
    ータを組み合わせて画像コンバートを行うためのものです。

      画像コンバートをする目的はいろいろありますが、この定義ファイル
    は細かい要求に答えるものではなく、とりあえず通常? の変換を行うの
    を楽にするためのものです。
      細かい指定とかをしたいときは、その都度、abx.exe の =変換文字列
    やレスポンス・ファイルを指定すればよいでしょう。
      完璧なんて求めずそれなりに楽をしませう、と。


      実際にこの定義ファイルを使うばあいは  abx.exe を abxg.exe に変
    名したものを別途用意するか、abxg.cfg を abx.cfg と変名して使うの
    がよいでせう。
      このドキュメントでは前者の場合として 以下 abxg といえばabx.exe
    を変名した abxg.exe と abxg.cfg との組み合わせのこととします。

    （でも実は私のはめんどくさがりなので abxg.cfg をabx.cfg に変名し
      て使ってたりしますが(ｵｲ)）



■  使い方

    usage : abxg.exe :IFMT:OFMT [オプション] ファイル名


  ●フォーマット指定:

    IFMT 入力フォーマット
                mag,pi,bmp,tif,pic,djp,blk,q4,gif,
                p2,q0,rgb,jpg
    OFMT 出力フォーマット
                mag,pi,bmp,tif,pic,djp,blk,q4,
                p2,q0,rgb,jpg

        ※  なお、可能な組み合わせについてや注意点はそれぞれ
            別項を参照してください。


  ●オプション指定:

        -r        ディレクトリ再帰する.

        -b-       実行せず、バッチのみ生成.

        -p<DIR>   出力先ディレクトリを <DIR> にする。
                  -p の指定のない場合は入力ディレクトリに生成される.

        -w<DIR>   テンポラリ・ディレクトリを<DIR>にする。
                  この指定のない場合は環境変数 TMP(またはTEMP)を参照
                  する.

        -i<DIR>   入力ディレクトリを <DIR> にする.
                  絶対パス以外の指定の場合、この <DIR> を基準にする.

        @RESFILE  レスポンス・ファイル指定.
                  resfileより -オプションやファイル名を得る。

        :         abxg.cfg に記入された変換名一覧表示.


      くわしくは abx.doc を参照してください。


  ●ファイル指定:

      ファイル名指定において拡張子が省略された場合、入力フォーマット
    の拡張子名が付加されます。

      くわしくは ABX.doc のファイル名指定を見てください。



■  行える変換

      とりあえず、以下の変換が行えます。
      左側が入力、右側が出力のフォーマットで、その組み合わせの指定は
    できるはずですが、ただし、入力と出力で同じフォーマットを指定しな
    いようにしてください（ものによってはうまくいくのもありますが、ば
    あいによっては入力・出力ファイルをともに破壊します）

            16 色画像に関する変換
                mag   +----+   mag
                pi    |    |   pi
                pic   |    |   pic
                q4    |    |   q4
                bmp ->|abxg|-> bmp
                tif   |    |   tif
                djp   |    |   djp
                blk   |    |   blk
                b1    |    |   b1
                gif   +----+   q0,rgb

            256色画像に関する変換
                mag   +----+   mag
                pi    |    |   pi
                pic   |    |   pic
                bmp ->|abxg|-> bmp
                tif   |    |   tif
                djp   |    |   djp
                gif   |    |   p2
                      +----+   q0,rgb

            多色画像に関する変換
                pic   +----+   pic
                p2    |    |   p2
                jpg   |    |   jpg
                bmp ->|abxg|-> bmp
                q0,rgb|    |   q0,rgb
                tif   |    |   djp
                      +----+

      ※  実際の定義ファイルにはこれら以外の変換も混ざってる場合があ
        ります^^;（くわしくは abxg.cfg を覗いてね）



■  必要な画像コンバータ(プログラム)

      以下のツールが path の通ったところに置かれているのを前提として
    います。

                                        Nifty-ID
        mg       (v0.96 MG096.LZH   )   NBB00541 てんかﾐ☆ (^^;
        picld    (v0.80 PICLD080.LZH)   〃
        picsv    (v0.80 PICSV080.LZH)   〃
        p2enc    (v2.00 P2TOLD02 LZH)   PDC01570 あべべ 氏
        p2dec    (v1.02 〃          )   〃
        tif2q0   (v1.03 TIF2Q013.LZH)   〃
        tif_plug (v1.11 TFPLGD1B.LZH)   〃
        gif_plug (v0.20 GIFP020.LZH )   KFB02167 みすらんであ 氏
        bmp_plug (v0.3  BMPPLG03.LZH)   PAG02643 ＫＯＨ 氏
        jpg_plug (v1.01 JPG_PLUG.LZH)   QGA00236 戦うクラリス 氏
        jpg2q0   (v1.06 JPG2Q016.LZH)   〃
        ej       (v1.3  EJ13.LZH    )   GAA01001 おそまき 氏
        bmp2jpg  (v1.01 JPGBMP01.LZH)   JCH01601 三崎 友明 氏
        jpg2bmp  (v1.00 〃          )   〃
        rastrn   (v1.2  RASTRN12.LZH)   QGB02273 kamiya 氏
        q4bmp    (v0.10 Q4BMP.LZH   )   GFD01322 mop 氏
        xcnsv4   (v0.45 XCNV_SV.LZH )   NBH01232 Dr.M 氏

      これらは一応 NIFTY で入手できるものです。
    ej は fpicst で、xcnsv4 と q4bmp は fqld1 で、 それ以外は fgalav
    で入手しました。

                ※  バージョン、ファイル名等は参考程度にしてください。
                    ぼくの手元にあったものを記しただけなので実際には
                    すでにバージョンアップされている可能性があります。



■  注意点など


      画像コンバートは、画像ファイルを改変する作業です。

      この abxg では、画素データ自体の改変は極力起きないようにしてい
    ますが、コンバートを行えばまずヘッダ情報の劣化が起こるものですし、
    場合によっては多少の減色などの画素データの改変が起こるものもあり
    ます。

      利用目的を考えそれにあった変換をしませう。
      利用する各画像フォーマットの性質や、各画像コンバータの機能・性
    質については、それらのドキュメントをみるなりして確認してください。
      わからずにやると後悔することがあるでせう。
      とくに、入手したＣＧを、ファイルサイズを小さくする目的で画像コ
    ンバートを行いそれを保存用とする場合は...
    （mag,pi などの 16色 256色画像を jpg に変換したものや pic やjpg
      等の多色画像を減色ツールとかで減色したものを元を削除して保存用
      にするとかの哀しいことはやめませう^^;）


  ●  エラーが起きた時

      abx はバッチを生成して、それを実行することに変換を行うのですが、
    途中で（いずれかのプログラムで）エラーが発生したときのことを想定
    していません。
      エラーが発生すると、結構不幸な状態に陥るかもしれません。

      生成先やテンポラリのあるディスクの空き容量は余裕をみて用意して
    ください。
      また、指定する画像ファイルの性質とコンバータの関係は十分気をつ
    けましょう。


  ●  画像のドットの縦横比（アスペクト比）について

      変換する画像は、基本的にドットの縦横比（アスペクト比）が、 1:1
    であるもののみです（例外:pic<=>pi,bmp,tif）。

      1:1 でない画像を変換した場合の処理は不定です。単に比率を無視す
    るだけか、それとも比率に従って画像サイズ自体を改変（拡大縮小）す
    るかは使われるコンバータしだいです。

      たいていは 1:1 とみなせると思いますが、 問題となるのは X68K な
    画像（主に PIC）と、古い時代の 640*200 な画像でしょう（あとMSX系
    の画像もかな）。640*200 な画像はそんなに問題ないでしょうが、X68K
    な画像(PIC)は、 ローダとかが表示するときにめんどくさい横長の変な
    比率だし、けど結構普及していてるしで、 頭が痛くなる存在かも^^;

      一応、pic <==> pi,bmp,tif に関しては(ある程度)比率が保存される
    変換をします。
      が、その他については X68K 画像は不幸です。とくに、 p2 <==> pic
    変換は X68K な画像に対応していないので哀しい思いをするでしょう。


  ●  16色、256色画像の変換について

      基本的にはこの種の変換では、画素の改変は起きないはずですが、パ
    レットデータはものによっては、改変されます。

      ただし mg.exe を利用した変換を行う場合、-xc というオプションを
    利用して入力した画像が 256色画像で、かつパレットの 16 番〜 255番
    までの色がすべて 0の場合は先頭16色のみからなる16色画像として扱う
    ようにしています。16色画像を djpプラグインなツールで変換して 256
    色になった場合を想定しています。
      場合によっては誤変換を起こす可能性があるのですが大抵はこれでう
    まくいくだろうと期待してこのようにしています。


  ●  多色 PIC の注意

      PIC 画像を他に変換するばあい、15ビット色や16ビット色は、24ビッ
    ト色に変換されてしまい、もとの色数がわからなくなります。
      まあ、これはいいとして、問題は PIC への変換で、24ビット色は 16
    ビット色に減色(単純に下位ビットをすてる)されてしまいます。


  ●  TIFF の注意

      TIFF画像はなんでも在り在りなので、変換できないものがあって当然
    です.
      でもTIFF入力は、あべべ氏の tiff2q0,tif_plug を使うようにしてる
    のでけっこう変換できるでせう。
      生成は無圧縮ですが、どのようなタグかはコンバータしだい、です。


  ●  BMP の注意

      ウィンドウズの無圧縮の BMP にしか対応していないでせう。


  ●  Q0,RGB の注意

      基本的に対応するヘッダファイルは Q0 なら .fal、RGB なら .iprと
    いうことにしていますが、場合(ツール)によっては RGB でも .falを生
    成するものもあります。ま、仕様ということで。


  ●  JPG の注意

      JPG は非可逆なフォーマットです。
      クオリティ 100%で変換するようにしていますが、100% でも変換誤差
    があるもので、変わっちゃう画素があるので扱いには注意してください。



■  おわりに

      配布条件等の扱いは abx.doc のほうをみてください。

      とりあえず abxの定義ファイルのサンプルとして書いてみただけ、の
    ものですので、うそなバッチを生成してる可能性がけっこうあるかも^^;

      実際、ぼく自身が試したのは、これらの変換のうちの 10分の1もない
    です^^;

      いろいろと書き漏らしてることもあるだろうけど、そんときはゴメン
    て、ことで。



                                        てんかﾐ☆ （きたむらまさし）
                        NIFTY                           NBB00541
                        OnlineUSA倶楽部(06-307-5407)    10
                                (旧名:100MEGA-NET 等)
